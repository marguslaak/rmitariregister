[{"model": "metadata.workflow", "pk": 999, "fields": {"name": "Validatsioonireeglid"}},{"model": "metadata.stepdefinition", "pk": 1000, "fields": {"workflow": 999, "order": 1, "sql_query": "SELECT pull_file('https://avaandmed.ariregister.rik.ee/sites/default/files/avaandmed/ettevotja_rekvisiidid__osanikud.json.zip', 'ettevotja_rekvisiidid__osanikud.json')", "result_filename": "ettevotja_rekvisiidid__osanikud.json.zip", "validation_schema": null, "engine": "SQL"}}, {"model": "metadata.stepdefinition", "pk": 1001, "fields": {"workflow": 999, "order": 5, "sql_query": "SELECT pull_file('https://avaandmed.ariregister.rik.ee/sites/default/files/1.aruannete_yldandmed_kuni_31032024.zip', '1.aruannete_yldandmed_kuni_31032024.csv')", "result_filename": "1.aruannete_yldandmed_kuni_31032024.zip", "validation_schema": null, "engine": "SQL"}}, {"model": "metadata.stepdefinition", "pk": 1002, "fields": {"workflow": 999, "order": 7, "sql_query": "SELECT pull_file('https://avaandmed.ariregister.rik.ee/sites/default/files/4.2022_aruannete_elemendid_kuni_31032024.zip', '4.2022_aruannete_elemendid_kuni_31032024.csv')", "result_filename": "4.2022_aruannete_elemendid_kuni_31032024.zip", "validation_schema": null, "engine": "SQL"}}, {"model": "metadata.stepdefinition", "pk": 1003, "fields": {"workflow": 999, "order": 3, "sql_query": "SELECT b.ariregistri_kood AS company_code, (SELECT ariregistri_kood FROM '13_11_lihtandmed.parquet' b_codes WHERE b_codes.ariregistri_kood = b.ariregistri_kood) as company_code2, b.nimi AS company_name, stk.osanikud.isikukood_registrikood AS stk_code, CAST(stk.osanikud.osaluse_protsent AS BIGINT) AS stk_pct, stk.osanikud.algus_kpv AS stk_start_date, stk.osanikud.lopp_kpv AS stk_end_date FROM 'ettevotja_rekvisiidid__osanikud.json' b, unnest(b.osanikud) stk", "result_filename": "Omandiinfo kvaliteedikontroll", "validation_schema": {"stk_pct": {"type": "float", "range": {"max_val": 100, "min_val": 0}, "nullable": false}, "stk_code": {"type": "int", "nullable": false, "compare_to": {"to": "company_code", "equals": false}, "business_code_or_personal_code": true}, "warn_only": true, "company_code": {"type": "int", "unique": false, "nullable": false, "compare_to": {"to": "company_code2", "equals": true}, "business_code": true}, "stk_end_date": {"type": "string", "is_date": true, "nullable": true}, "stk_start_date": {"type": "string", "is_date": true, "nullable": false}}, "engine": "SQL"}}, {"model": "metadata.stepdefinition", "pk": 1004, "fields": {"workflow": 999, "order": 2, "sql_query": "SELECT pull_file('https://avaandmed.ariregister.rik.ee/sites/default/files/13_11_lihtandmed.parquet_0.zip', '13_11_lihtandmed.parquet')", "result_filename": "13_11_lihtandmed.parquet", "validation_schema": null, "engine": "SQL"}}, {"model": "metadata.stepdefinition", "pk": 1005, "fields": {"workflow": 999, "order": 4, "sql_query": "SELECT b.ariregistri_kood as company_code FROM '13_11_lihtandmed.parquet' b", "result_filename": "Lihtandmete kvaliteedikontroll", "validation_schema": {"warn_only": true, "company_code": {"type": "int", "unique": false, "nullable": false, "business_code": true}}, "engine": "SQL"}}, {"model": "metadata.stepdefinition", "pk": 1006, "fields": {"workflow": 999, "order": 6, "sql_query": "SELECT b.registrikood as company_code, b.aruandeaast as year, EXTRACT(YEAR FROM CURRENT_DATE) as current_year FROM '1.aruannete_yldandmed_kuni_31032024.csv' b", "result_filename": "Aruannete andmete kvaliteedikontroll 1", "validation_schema": {"year": {"type": "int", "unique": false, "nullable": false, "compare_to": {"to": "current_year", "equals": true}}, "warn_only": true, "company_code": {"type": "int", "unique": false, "nullable": false, "business_code": true}}, "engine": "SQL"}}, {"model": "metadata.stepdefinition", "pk": 1007, "fields": {"workflow": 999, "order": 8, "sql_query": "SELECT b.vaartus FROM '4.2022_aruannete_elemendid_kuni_31032024.csv' b", "result_filename": "Aruannete andmete kvaliteedikontroll 2", "validation_schema": {"vaartus": {"type": "float", "unique": false, "nullable": false}, "warn_only": true}, "engine": "SQL"}}]